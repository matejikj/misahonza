---
import { homepageData } from "../../data/homepage";
import { withBase } from "../../utils/withBase";
import ButtonLink from "../ui/ButtonLink.astro";
import SectionHeading from "../ui/SectionHeading.astro";

interface Props {
  projects: typeof homepageData.projects;
}

const { projects } = Astro.props;
const projectItems = projects.items.map((item) => ({ ...item, image: withBase(item.image) }));
---

<section id="projects" class="section-shell-xl projects-editorial bg-bg">
  <div class="container-page">
    <div class="grid gap-8 lg:grid-cols-12 lg:items-end">
      <div class="lg:col-span-7" data-motion-reveal>
        <SectionHeading title={projects.title} description={projects.intro} />
      </div>
      <div class="flex flex-col gap-3 sm:flex-row lg:col-span-5 lg:justify-end" data-motion-reveal>
        <ButtonLink href={projects.ctas[0].href} label={projects.ctas[0].label} variant="secondary" />
        <ButtonLink href={projects.ctas[1].href} label={projects.ctas[1].label} />
      </div>
    </div>

    <div class="mt-10 space-y-8">
      {projectItems.map((project, index) => {
        const mediaOrder = index % 2 === 0 ? "lg:order-1" : "lg:order-2";
        const contentOrder = index % 2 === 0 ? "lg:order-2" : "lg:order-1";

        return (
          <article
            class="project-case surface-panel overflow-hidden"
            data-motion-reveal
            style={`--reveal-delay:${Math.min(index * 110, 280)}ms`}
          >
            <div class="grid gap-0 lg:grid-cols-12">
              <figure class:list={["project-media relative lg:col-span-7", mediaOrder]}>
                <img
                  src={project.image}
                  alt={`Realizace: ${project.title}`}
                  class="h-full w-full object-cover object-center"
                  loading="lazy"
                  decoding="async"
                />
                <div class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/32 via-black/12 to-transparent"></div>
                <figcaption class="absolute inset-x-4 bottom-4 rounded-md border hairline bg-surface/86 px-3 py-2 text-sm text-text backdrop-blur">
                  {project.imageLabel}
                </figcaption>
              </figure>

              <div class:list={["project-content p-5 md:p-6 lg:col-span-5", contentOrder]}>
                <p class="editorial-caption">Case {String(index + 1).padStart(2, "0")}</p>
                <h3 class="mt-3 text-2xl font-display leading-tight">{project.title}</h3>
                <p class="mt-4 text-sm leading-6 text-text-muted">{project.insight}</p>

                <dl class="mt-6 space-y-3">
                  <div class="case-fact">
                    <dt class="editorial-caption">Zadání</dt>
                    <dd class="mt-1 text-sm leading-6 text-text">{project.brief}</dd>
                  </div>
                  <div class="case-fact">
                    <dt class="editorial-caption">Řešení</dt>
                    <dd class="mt-1 text-sm leading-6 text-text">{project.solution}</dd>
                  </div>
                  <div class="case-fact">
                    <dt class="editorial-caption">Efekt světla</dt>
                    <dd class="mt-1 text-sm leading-6 text-text">{project.lightEffect}</dd>
                  </div>
                </dl>

                <div class="mt-6 grid gap-2 rounded-md border hairline bg-bg-soft/55 p-3 text-sm sm:grid-cols-2">
                  <p>
                    Lokalita: <span class="font-medium text-text">{project.location}</span>
                  </p>
                  <p>
                    Povrch: <span class="font-medium text-text">{project.surface}</span>
                  </p>
                </div>
              </div>
            </div>
          </article>
        );
      })}
    </div>
  </div>
</section>

<style>
  .projects-editorial {
    position: relative;
    overflow: clip;
  }

  .projects-editorial::before {
    content: "";
    position: absolute;
    inset: 0;
    background:
      radial-gradient(circle at 8% 10%, rgba(183, 140, 90, 0.09), transparent 44%),
      radial-gradient(circle at 92% 84%, rgba(143, 163, 164, 0.09), transparent 42%);
    pointer-events: none;
  }

  .project-media {
    min-height: 20rem;
  }

  .case-fact {
    border: 1px solid rgba(110, 106, 99, 0.2);
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.72);
    padding: 0.72rem 0.8rem;
    transition:
      transform var(--motion-hover, 260ms) var(--motion-ease, cubic-bezier(0.25, 0.8, 0.25, 1)),
      border-color var(--motion-hover, 260ms) var(--motion-ease, cubic-bezier(0.25, 0.8, 0.25, 1));
  }

  .project-case:hover .case-fact,
  .project-case:focus-within .case-fact {
    transform: translateY(-2px);
    border-color: rgba(183, 140, 90, 0.3);
  }

  @media (min-width: 1024px) {
    .project-media {
      min-height: 26rem;
    }
  }
</style>
